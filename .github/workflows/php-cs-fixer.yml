name: php-cs-fixer

env:
  PR_NUMBER: "${{ github.event.number }}"
  SOURCE_BRANCH: "$GITHUB_HEAD_REF"
  FIXER_BRANCH: "auto-fixed/$GITHUB_HEAD_REF"
  TITLE: "Apply fixes from PHP-CS-Fixer"
  DESCRIPTION: "This merge request applies PHP code style fixes from an analysis carried out through GitHub Actions."

on: [ push, pull_request ]

jobs:
  php-cs-fixer:
    runs-on: [self-hosted, linux, x64]

    name: Run PHP CS Fixer

    steps:
      - name: Run PHPCS
        run: |
          curl -OL https://squizlabs.github.io/PHP_CodeSniffer/phpcs.phar >> /tmp/phpcs.phar && \
          cp /tmp/phpcs.phar /usr/local/bin/phpcs && \
          chmod +x /usr/local/bin/phpcs && \
          /usr/local/bin/phpcs *.php
